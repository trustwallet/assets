name: ğŸ”’ Ù…Ø­Ø§ÙØ¸ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù…

on:
  pull_request:
    branches: [ main, master ]
  push:
    branches: [ main, master ]

jobs:
  guard:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø¯
        uses: actions/checkout@v4

      - name: ğŸ›¡ï¸ Ú†Ú© Ú©Ø±Ø¯Ù† ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ
        id: check
        run: |
          MISSING=""
          FILES=(
            ".github/dependabot.yml"
            "info.json"
            "logo.png"
          )
          for file in "${FILES[@]}"; do
            if [ ! -f "$file" ]; then
              echo "âš ï¸ ÙØ§ÛŒÙ„ Ú¯Ù… Ø´Ø¯Ù‡: $file"
              MISSING="$MISSING\n- $file"
            fi
          done
          
          if [ -n "$MISSING" ]; then
            echo "missing=true" >> $GITHUB_ENV
            echo "missing_files=$MISSING" >> $GITHUB_ENV
          else
            echo "missing=false" >> $GITHUB_ENV
          fi

      - name: ğŸš« Ø¨Ø³ØªÙ† PR Ø¯Ø± ØµÙˆØ±Øª Ú¯Ù… Ø´Ø¯Ù† ÙØ§ÛŒÙ„
        if: github.event_name == 'pull_request' && env.missing == 'true'
        run: |
          echo "::error::âŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ ØªÙˆÛŒ Ø§ÛŒÙ† PR Ù¾Ø§Ú© Ø´Ø¯Ù†: ${{ env.missing_files }}"
          exit 1
